{% extends 'adminTemplate.html.twig' %}
{% block title %}Utilisateurs - Dashboard{% endblock %}
{% block content %}

    <form id="delete_form" method="POST" action="">
        <input type="hidden" value="{{ session._sf2_attributes.token }}" id="formtoken" name="formtoken">
        <input type="hidden" name="submit_delete_form">
    </form>

    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Visites</h1>
        <div class="btn-toolbar mb-2 mb-md-0">

        </div>
    </div>
    <h2>Listes des utilisateurs</h2>
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
            <tr>
                <th scope="col">Username</th>
                <th scope="col">Email</th>
                <th scope="col">Rôle</th>
                <th scope="col">Supprimer</th>
            </tr>
            </thead>
            <tbody>
            {% for user in users %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{% if user.userStatus == 1 %}Admin{% else %}Visiteur{% endif %}</td>
                    <td class="text-center"><a href="" data-id="{{ user.userId }}" class="fa-solid fa-trash-can submit-form"></a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
{% block addjavascripts %}
    <script type="text/javascript">
        $(document).ready(function () {
            $("a.submit-form").click(function (eventObject) {
                eventObject.preventDefault();
                var answer = confirm("Etes-vous sûr de vouloir supprimer cet utilisateur?");
                if (answer) {
                    var id = $(this).attr("data-id");
                    form = $("#delete_form");
                    form.attr("action", "/admin/users/delete/" + id);
                    form.submit();
                }
            });
        });
    </script>
{% endblock %}